<!doctype html>
<html lang="en">
	<head>
		<title>CCMT Cutoff Viewer Tool</title>

		<meta name="keywords" content="CCMT, cutoff, tool, viewer, previous year, GATE, gate score">
		<meta name="description" content="View CCMT GATE score cutoffs of previous years in a neat tabular form, with options to sort and highlight all eligible courses.">
		<meta property="og:title" content="CCMT Cutoff Viewer Tool">
		<meta property="og:description" content="View CCMT GATE score cutoffs of previous years in a neat tabular form, with options to sort and highlight all eligible courses.">
		<meta property="og:url" content="https://piyushs528.github.io/CCMT/CCMT.html">
		<meta property="og:image" content="https://piyushs528.github.io/CCMT/thumb.png">

		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<link rel="icon" type="image/x-icon" href="./favicon.ico">

		<style type="text/css">
			html, body, input, button, select {
				font-family: sans-serif;
			}
			html, body {
				background: #cfdfef;
			}
			fieldset {
				border: 1px dashed #000000;
			}
			select {
				height: 2em;
			}
			input[type="number"] {
				height: 2em;
			}
			label {
				border: 1px solid rgba(0, 0, 0, 0.5);
				border-radius: 5em;
				border-width: 0 0 1px 1px;
				cursor: pointer;
				line-height: 2em;
				padding: 0.2em 1em;
			}
			button {
				background: #efefef;
				border: 1px solid #000000;
				border-radius: 5px;
				cursor: pointer;
				padding: 0.5em 2em;
			}
			button:hover {
				background: #cfeff7;
			}
			button:active {
				background: #2fcfff;
			}
			
			#cutoff_table {
				border: 1px solid black;
			}
			#cutoff_table td, #cutoff_table th {
				border: 1px solid black;
				border-width: 0 1px 1px 0;
				padding: 5px;
			}
			.default{
				background: #ffffff !important;
			}
			.grey{
				background: url("./null-hatch.png") #cfcfcf !important;
			}
			.good{
				background: #cfffcf !important;
			}
			.bad{
				background: #efafaf !important;
			}
			.default td, .default th{
				background: #ffffff;
			}
			.grey td, .grey th {
				background: url("./null-hatch.png") #cfcfcf;
			}
			.good td, .good th{
				background: #cfffcf;
			}
			.bad td, .bad th{
				background: #efafaf;
			}

			#totalCount {
				font-weight: bold;
			}
			#goodCount {
				font-weight: bold;
				color: #3faf3f;
			}
			#badCount {
				font-weight: bold;
				color: #af3f3f;
			}
			#zeroCount {
				font-weight: bold;
				color: #6f6f6f;
			}
		</style>
		<script type="text/javascript" src="./data.js"></script>
	</head>

	<body>
		<h1> CCMT Cutoff Viewer Tool </h1>

		<em style="font-size: 0.8em">
			Last Updated: 19-Jun-2022 <br>
			(Source: <a href="https://ccmt.admissions.nic.in/or-cr/" target="_blank">https://ccmt.admissions.nic.in/or-cr/</a> (new tab) )
		</em> <br><br>

		<fieldset id="fields">
			Year:
			<select id="ccmt_year" onchange="yearChanged()">
				<option value="year2022">2022</option>
				<option value="year2021" selected>2021</option>
				<option value="year2020">2020</option>
				<option value="year2019">2019</option>
			</select> <br>

			Round:
			<select id="ccmt_round">
				<option value="Round 1" selected>Round 1</option>
				<option value="Round 2">Round 2</option>
				<option value="Round 3">Round 3</option>
			</select> <br><br>

			GATE Score: <input type="number" id="gate_score" value="0"> <br>

			Category:
			<select id="category">
				<option value="0">GEN (Open)</option>
				<option value="1">GEN-PwD (Open-PwD)</option>
				<option value="2">EWS</option>
				<option value="3">EWS-PwD</option>
				<option value="4">OBC-NCL</option>
				<option value="5">OBC-NCL-PwD</option>
				<option value="6">SC</option>
				<option value="7">SC-PwD</option>
				<option value="8">ST</option>
				<option value="9">ST-PwD</option>
			</select> <br>

			Show:
			<select id="table_view">
				<option value="0">All Courses</option>
				<option value="2">Accepting Courses</option>
				<option value="1">Accepting Courses (include zero seats)</option>
			</select> <br><br>

			Sort by:
			<select id="sort_by">
				<option value="0">Institute Name</option>
				<option value="2">Program (Course) Name</option>
				<option value="4">MAX cutoff</option>
				<option value="6">MIN cutoff</option>
				<option value="8">Average cutoff</option>
			</select> <br>
			<label><input type="radio" name="sortOrder" id="order_asc" checked> Ascending</label> &nbsp;
			<label><input type="radio" name="sortOrder" id="order_desc"> Descending</label> <br><br>

			<button id="go" onclick="parseTable()">UPDATE</button>
		</fieldset> <br>

		Accepting Courses: <span id="goodCount"></span> <br>
		Rejecting Courses: <span id="badCount"></span> <br>
		Zero Seats: <span id="zeroCount"></span> <br>
		Total Courses: <span id="totalCount"></span> <br><br>

		(Note: MAX and MIN values indicate GATE scores) <br><br>

		<table id="cutoff_table" cellspacing="0"></table>

		<script type="text/javascript">
			function yearChanged() {		// Update 'round' selection box if 'year' selection is changed 
				var ccmt_year = document.getElementById ("ccmt_year").value;
				var ccmt_rounds = document.getElementById ("ccmt_round");

				ccmt_rounds.innerHTML = "";
				for (var r in scores[ccmt_year]) {
					var option = document.createElement("option");
					option.setAttribute("value", r);
					var text = document.createTextNode(r);
					option.appendChild(text);
					ccmt_rounds.appendChild(option);
				}
			}
			function addCell (tr, str, classList) {		// append <td class=(classList)>(str)</td> in tr table row
				var td = document.createElement("td");
				var text = document.createTextNode (str);
				if (classList) td.className += " "+classList;
				td.appendChild(text);
				tr.appendChild(td);
				return td;
			}
			function addHeader (tr, str, classList) {		// append <th class=(classList)>(str)</th> in tr table row
				var th = document.createElement("th");
				var text = document.createTextNode (str);
				if (classList) th.className += " "+classList;
				th.appendChild(text);
				tr.appendChild(th);
				return th;
			}
			function addTableHeader (table) {
				var tr, th;

				var tr = document.createElement ("tr");
				tr.className += " grey";

				th = addHeader(tr, "Sr. No."); th.setAttribute("rowspan", 2);
				th = addHeader(tr, "Institute Name"); th.setAttribute("rowspan", 2);
				th = addHeader(tr, "Program Name"); th.setAttribute("rowspan", 2);
				th = addHeader(tr, "Group Id"); th.setAttribute("rowspan", 2);
				th = addHeader(tr, "GEN"); th.setAttribute("colspan", 2);
				th = addHeader(tr, "GEN-PwD"); th.setAttribute("colspan", 2);
				th = addHeader(tr, "EWS"); th.setAttribute("colspan", 2);
				th = addHeader(tr, "EWS-PwD"); th.setAttribute("colspan", 2);
				th = addHeader(tr, "OBC-NCL"); th.setAttribute("colspan", 2);
				th = addHeader(tr, "OBC-NCL-PwD"); th.setAttribute("colspan", 2);
				th = addHeader(tr, "SC"); th.setAttribute("colspan", 2);
				th = addHeader(tr, "SC-PwD"); th.setAttribute("colspan", 2);
				th = addHeader(tr, "ST"); th.setAttribute("colspan", 2);
				th = addHeader(tr, "ST-PwD"); th.setAttribute("colspan", 2);
				table.appendChild(tr);

				var tr = document.createElement ("tr");
				tr.className += " grey";

				for (var i = 0; i < 10; ++i) {
					addHeader(tr, "MAX");
					addHeader(tr, "MIN");
				}
				table.appendChild(tr);
			}
			function insSort(d, cmp) {		// insertion sort with cmp() as comparing function
				for (var i = 1; i < d.length; ++i) {
					for (var j = i; j > 0; --j) {
						if (cmp(d[j-1], d[j]) > 0) {
							var temp = d[j];
							d[j] = d[j-1];
							d[j-1] = temp;
						}
						else break;
					}
				}
			}
			function sortData(data, sortBy, scoreindex) {		// scoreindex = starting index of score within data row (general category)
				switch (sortBy) {
					case 0: insSort(data, function (a, b) {return (a[0] <= b[0]) ? -1 : 1});	// Ascending institute name
						break;
					case 1: insSort(data, function (a, b) {return (b[0] <= a[0]) ? -1 : 1});	// Descending institute name
						break;
					case 2: insSort(data, function (a, b) {return (a[1] <= b[1]) ? -1 : 1});	// Ascending program name
						break;
					case 3: insSort(data, function (a, b) {return (b[1] <= a[1]) ? -1 : 1});	// Descending program name
						break;
					case 4: insSort(data, function (a, b) {return a[scoreindex] - b[scoreindex]});	// Ascending MAX score
						break;
					case 5: insSort(data, function (a, b) {return b[scoreindex] - a[scoreindex]});	// Descending MAX score
						break;
					case 6: insSort(data, function (a, b) {return a[scoreindex+1] - b[scoreindex+1]});	// Ascending MIN score
						break;
					case 7: insSort(data, function (a, b) {return b[scoreindex+1] - a[scoreindex+1]});	// Descending MIN score
						break;
					case 8: insSort(data, function (a, b) {return (a[scoreindex]+a[scoreindex+1])/2 - (b[scoreindex+1]+b[scoreindex])/2});	// Ascending (MAX+MIN)/2 (average)
						break;
					case 9: insSort(data, function (a, b) {return (b[scoreindex]+b[scoreindex+1])/2 - (a[scoreindex+1]+a[scoreindex])/2});	// Descending (MAX+MIN)/2 (average)
						break;
				}
				return data;
			}
			function parseTable() {
				var ccmt_year = document.getElementById ("ccmt_year").value;
				var ccmt_round = document.getElementById ("ccmt_round").value;
				var data;
				var gate_score = parseInt(document.getElementById ("gate_score").value);
				if (!gate_score) gate_score = 0;
				var category = 2 * parseInt(document.getElementById ("category").value);
				var tableView = parseInt(document.getElementById ("table_view").value);
				var sortBy = parseInt(document.getElementById ("sort_by").value);
				sortBy = (document.getElementById ("order_asc").checked) ? sortBy : (sortBy+1);

				var table = document.getElementById ("cutoff_table");
				while (table.firstChild)
					table.removeChild (table.lastChild);	// clears the table
				addTableHeader(table);

				var data = scores[ccmt_year][ccmt_round];

				var goodCount = 0, zeroCount = 0, totalCount = 0;

				data = sortData(data, sortBy, category+3);

				for (var i = 0; i < data.length; ++i) {
					var s = data[i];
					var scoreCellNumber = 0, row = document.createElement("tr");
					addCell(row, i+1);

					for (var j = 0; j < s.length; ++j) {
						if (j < 2)
							addCell (row, s[j]);
						else if (j === 2)
							addCell (row, s[j], "default");
						else if (j > 2) {
							if (scoreCellNumber === category || scoreCellNumber === category+1) {
								if (s[j] === 0) {
									addCell(row, s[j], "grey");
									row.className += " grey";
									if (scoreCellNumber === category) ++zeroCount;
									if (tableView >= 2) {
										row = null;
										break;
									}
								}
								else if (gate_score >= s[j]) {
									addCell(row, s[j], "good");
									row.className += " good";
									if (scoreCellNumber === category+1) ++goodCount;
								}
								else if (gate_score < s[j]) {
									addCell(row, s[j], "bad");
									if (scoreCellNumber === category+1) {
										row.className += " bad";
										if (tableView >= 1) {
											row = null;
											break;
										}
									}
								}
							}
							else addCell(row, s[j], "default");

							++scoreCellNumber;
						}
						if (j === s.length - 1) {
							++totalCount;
							table.appendChild(row);
						}
					}
				}
				document.getElementById("totalCount").innerHTML = i;
				document.getElementById("goodCount").innerHTML = goodCount;
				document.getElementById("badCount").innerHTML = i - goodCount - zeroCount;
				document.getElementById("zeroCount").innerHTML = zeroCount;
			}
			document.body.onload = function() {		// Group by institute name, sort by program name for every list
				for (var year in scores) {
					for (var round in scores[year]) {
						sortData(scores[year][round], 2);
						sortData(scores[year][round], 0);
					}
				}
				parseTable();
			}
		</script>
	</body>
</html>
		
